<!DOCTYPE html>
<html lang="zh-CN" class="no-js">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'none';
        style-src 'unsafe-inline' https: http:;
        script-src 'unsafe-inline' 'unsafe-eval' https: http:;
        img-src https: http: data: blob:;
        font-src https: http: data:;
        connect-src * https: http: ws: wss: data: blob:;
        worker-src blob:;
        child-src blob:;
    ">
    <title>MyBricks.ai Designer</title>
    
    <!-- æ€§èƒ½ä¼˜åŒ–å…ƒæ ‡ç­¾ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <!-- é¢„è¿æ¥åˆ° CDN ä»¥åŠ é€Ÿèµ„æºåŠ è½½ -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="preconnect" href="https://p4-ec.eckwai.com" crossorigin>
    <link rel="preconnect" href="https://p2-ec.eckwai.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://unpkg.com">
    
    <!-- INLINE_CSS -->

    <!-- React 18 æ ¸å¿ƒåº“ - ä½¿ç”¨ç”Ÿäº§ç‰ˆæœ¬æå‡æ€§èƒ½ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" defer></script>

    <!-- Babel Standalone æ”¯æŒåœ¨æµè§ˆå™¨å†…ç¼–è¯‘ TSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>

    <!-- Ant Design 5 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.13/dayjs.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/antd/5.22.7/antd.min.js" defer></script>
    <script src="https://f2.eckwai.com/kos/nlav11092/fangzhou/pub/temp/1690444248634.ant-design-icons_4.7.0_min.js" defer></script>

    <!-- MyBricks SDA å¼•æ“ -->
    <script src="https://p4-ec.eckwai.com/kos/nlav12333/mybricks/designer-spa/3.9.836/index.min.js" defer></script>

    <!-- MyBricks æœåŠ¡æ¥å£è¿æ¥å™¨æ’ä»¶ -->
    <script src="https://p2-ec.eckwai.com/kos/nlav12333/mybricks/plugin-http-connector/1.2.30/plugin.9a7ecd7bfad260c2.js" defer></script>
    
    <!-- æ€§èƒ½ç›‘æ§è„šæœ¬ -->
    <script>
        // å¼ºåˆ¶å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ
        document.addEventListener('DOMContentLoaded', function() {
            // å¼ºåˆ¶é‡ç»˜ä»¥æ¿€æ´» GPU åŠ é€Ÿ
            document.body.style.transform = 'translateZ(0)';
            document.body.style.backfaceVisibility = 'hidden';
            document.body.style.perspective = '1000px';
        });
    </script>
</head>

<body>
    <!-- å¼€å‘æ¨¡å¼é‡è½½æŒ‰é’® -->
    <div id="dev-reload-btn" style="position: fixed; bottom: 20px; left: 20px; z-index: 999999; display: none;">
        <button onclick="location.reload()" style="
            background: #4ade80;
            color: #1a1a1a;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            font-size: 14px;
        ">
            ğŸ”„ é‡æ–°åŠ è½½
        </button>
    </div>
    
    <div id="root"></div>

    <script>
        // ====== è¯¦ç»†çš„é”™è¯¯æ•è·å’Œæ˜¾ç¤ºç³»ç»Ÿ ======
        
        console.log('ğŸš€ MyBricks: HTML å·²åŠ è½½');
        console.log('ğŸ“¦ æ£€æŸ¥ä¾èµ–åŠ è½½çŠ¶æ€...');
        
        // åˆ›å»ºé”™è¯¯æ˜¾ç¤ºé¢æ¿
        const errorPanel = document.createElement('div');
        errorPanel.id = 'error-panel';
        errorPanel.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 30px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", monospace;
            font-size: 13px;
            z-index: 999999;
            overflow-y: auto;
            display: none;
        `;
        
        const errorContent = document.createElement('div');
        errorContent.style.cssText = 'max-width: 1000px; margin: 0 auto;';
        errorPanel.appendChild(errorContent);
        
        let errorCount = 0;
        let hasErrors = false;
        
        function showErrorPanel() {
            if (!document.body.contains(errorPanel)) {
                document.body.appendChild(errorPanel);
            }
            errorPanel.style.display = 'block';
            hasErrors = true;
        }
        
        function addError(title, details, stack) {
            errorCount++;
            showErrorPanel();
            
            const errorBlock = document.createElement('div');
            errorBlock.style.cssText = `
                background: rgba(255, 107, 107, 0.1);
                border-left: 4px solid #ff6b6b;
                padding: 20px;
                margin: 15px 0;
                border-radius: 8px;
            `;
            
            errorBlock.innerHTML = `
                <div style="font-size: 16px; font-weight: bold; color: #ff6b6b; margin-bottom: 10px;">
                    âŒ é”™è¯¯ #${errorCount}: ${escapeHtml(title)}
                </div>
                <div style="color: #ffd700; margin: 10px 0;">
                    è¯¦æƒ…: ${escapeHtml(details)}
                </div>
                ${stack ? `
                    <details style="margin-top: 10px;">
                        <summary style="cursor: pointer; color: #4ade80;">ğŸ“‹ å †æ ˆè·Ÿè¸ª</summary>
                        <pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; overflow-x: auto; margin-top: 10px;">${escapeHtml(stack)}</pre>
                    </details>
                ` : ''}
            `;
            
            errorContent.appendChild(errorBlock);
        }
        
        function addInfo(title, details) {
            const infoBlock = document.createElement('div');
            infoBlock.style.cssText = `
                background: rgba(74, 222, 128, 0.1);
                border-left: 4px solid #4ade80;
                padding: 15px;
                margin: 10px 0;
                border-radius: 8px;
            `;
            
            infoBlock.innerHTML = `
                <div style="font-size: 14px; font-weight: bold; color: #4ade80; margin-bottom: 5px;">
                    ${title}
                </div>
                <div style="color: #e0e0e0;">
                    ${details}
                </div>
            `;
            
            errorContent.appendChild(infoBlock);
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // åˆ›å»ºç®€æ´çš„çŠ¶æ€æ 
        const statusBar = document.createElement('div');
        statusBar.id = 'status-bar';
        statusBar.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            z-index: 999998;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        `;
        statusBar.innerHTML = 'â³ æ­£åœ¨åŠ è½½...';
        
        // æ·»åŠ æ ‡é¢˜
        errorContent.innerHTML = `
            <h1 style="font-size: 28px; margin-bottom: 20px; color: #ff6b6b;">
                ğŸ” MyBricks è°ƒè¯•ä¿¡æ¯
            </h1>
            <div style="color: #999; margin-bottom: 30px;">
                ç”±äºæ— æ³•æ‰“å¼€ DevToolsï¼Œè¿™é‡Œæ˜¾ç¤ºæ‰€æœ‰é”™è¯¯å’ŒçŠ¶æ€ä¿¡æ¯
            </div>
        `;
        
        // æ•è·è„šæœ¬åŠ è½½é”™è¯¯
        document.addEventListener('DOMContentLoaded', function() {
            document.body.appendChild(statusBar);
            
            const scripts = document.querySelectorAll('script[src]');
            let loadedCount = 0;
            const totalScripts = scripts.length;
            
            scripts.forEach((script, index) => {
                script.addEventListener('load', function() {
                    loadedCount++;
                    console.log(`âœ… è„šæœ¬åŠ è½½æˆåŠŸ (${loadedCount}/${totalScripts}):`, script.src);
                    statusBar.innerHTML = `â³ åŠ è½½ä¸­... ${loadedCount}/${totalScripts}`;
                });
                
                script.addEventListener('error', function() {
                    console.error('âŒ è„šæœ¬åŠ è½½å¤±è´¥:', script.src);
                    addError(
                        'è„šæœ¬åŠ è½½å¤±è´¥',
                        script.src,
                        'è¿™é€šå¸¸æ˜¯ç½‘ç»œé—®é¢˜æˆ– CDN è¢«é˜»æ­¢å¯¼è‡´çš„'
                    );
                    statusBar.innerHTML = 'âŒ åŠ è½½å¤±è´¥ï¼ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…';
                    statusBar.style.cursor = 'pointer';
                    statusBar.style.background = 'rgba(255, 107, 107, 0.9)';
                    statusBar.onclick = () => showErrorPanel();
                });
            });
        });
        
        // æ•è·æ‰€æœ‰ JavaScript é”™è¯¯
        window.addEventListener('error', function(e) {
            console.error('âŒ JavaScript é”™è¯¯:', e);
            
            // å¦‚æœæ˜¯è„šæœ¬åŠ è½½é”™è¯¯ï¼Œå·²ç»åœ¨ä¸Šé¢å¤„ç†äº†
            if (e.target && (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK')) {
                return;
            }
            
            addError(
                e.message || 'æœªçŸ¥é”™è¯¯',
                `æ–‡ä»¶: ${e.filename || 'æœªçŸ¥'}\nè¡Œå·: ${e.lineno || '?'}:${e.colno || '?'}`,
                e.error ? e.error.stack : ''
            );
            
            statusBar.innerHTML = 'âŒ JS é”™è¯¯ï¼ç‚¹å‡»æŸ¥çœ‹';
            statusBar.style.cursor = 'pointer';
            statusBar.style.background = 'rgba(255, 107, 107, 0.9)';
            statusBar.onclick = () => showErrorPanel();
        }, true);
        
        // æ•è· Promise æ‹’ç»
        window.addEventListener('unhandledrejection', function(e) {
            console.error('âŒ Promise é”™è¯¯:', e);
            
            addError(
                'Promise è¢«æ‹’ç»',
                e.reason?.message || String(e.reason),
                e.reason?.stack || ''
            );
            
            statusBar.innerHTML = 'âŒ Promise é”™è¯¯ï¼ç‚¹å‡»æŸ¥çœ‹';
            statusBar.style.cursor = 'pointer';
            statusBar.style.background = 'rgba(255, 107, 107, 0.9)';
            statusBar.onclick = () => showErrorPanel();
        });
        
        // æ£€æŸ¥ä¾èµ–åŠ è½½
        window.addEventListener('load', function() {
            console.log('âœ… window.load äº‹ä»¶è§¦å‘');
            
            setTimeout(function() {
                const checks = [
                    { name: 'React', obj: window.React, url: 'https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/...' },
                    { name: 'ReactDOM', obj: window.ReactDOM, url: 'https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/...' },
                    { name: 'Babel', obj: window.Babel, url: 'https://unpkg.com/@babel/standalone/...' },
                    { name: 'antd', obj: window.antd, url: 'https://cdnjs.cloudflare.com/ajax/libs/antd/5.22.7/...' },
                    { name: 'mybricks', obj: window.mybricks, url: 'https://p4-ec.eckwai.com/kos/nlav12333/mybricks/...' }
                ];
                
                const failed = checks.filter(c => typeof c.obj === 'undefined');
                const succeeded = checks.filter(c => typeof c.obj !== 'undefined');
                
                if (failed.length === 0 && !hasErrors) {
                    // æ‰€æœ‰ä¾èµ–åŠ è½½æˆåŠŸ
                    addInfo('âœ… æ‰€æœ‰ä¾èµ–åŠ è½½æˆåŠŸ', succeeded.map(c => `âœ“ ${c.name}`).join('<br>'));
                    statusBar.innerHTML = 'âœ… åŠ è½½æˆåŠŸï¼';
                    statusBar.style.background = 'rgba(74, 222, 128, 0.9)';
                    
                    // 3ç§’åéšè—
                    setTimeout(() => {
                        statusBar.style.display = 'none';
                        if (!hasErrors) {
                            errorPanel.style.display = 'none';
                        }
                    }, 3000);
                } else {
                    // æœ‰ä¾èµ–åŠ è½½å¤±è´¥
                    if (failed.length > 0) {
                        failed.forEach(dep => {
                            addError(
                                `${dep.name} åŠ è½½å¤±è´¥`,
                                dep.url,
                                'å¯èƒ½åŸå› ï¼š\n1. ç½‘ç»œè¿æ¥é—®é¢˜\n2. CDN è¢«é˜²ç«å¢™é˜»æ­¢\n3. éœ€è¦ VPN è®¿é—®'
                            );
                        });
                    }
                    
                    if (succeeded.length > 0) {
                        addInfo('âœ… å·²æˆåŠŸåŠ è½½', succeeded.map(c => `âœ“ ${c.name}`).join('<br>'));
                    }
                    
                    // æ·»åŠ è§£å†³æ–¹æ¡ˆ
                    const solutionBlock = document.createElement('div');
                    solutionBlock.style.cssText = `
                        background: rgba(255, 215, 0, 0.1);
                        border-left: 4px solid #ffd700;
                        padding: 20px;
                        margin: 20px 0;
                        border-radius: 8px;
                    `;
                    solutionBlock.innerHTML = `
                        <div style="font-size: 16px; font-weight: bold; color: #ffd700; margin-bottom: 10px;">
                            ğŸ’¡ è§£å†³æ–¹æ¡ˆ
                        </div>
                        <ol style="margin-left: 20px; line-height: 1.8;">
                            <li>æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸</li>
                            <li>å°è¯•ä½¿ç”¨ VPN</li>
                            <li>æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº† CDN è®¿é—®</li>
                            <li>åœ¨æµè§ˆå™¨ä¸­æµ‹è¯• CDN æ˜¯å¦å¯è®¿é—®</li>
                        </ol>
                        <div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 4px;">
                            <strong>æµ‹è¯•å‘½ä»¤ï¼š</strong><br>
                            <code>curl -I https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js</code>
                        </div>
                    `;
                    errorContent.appendChild(solutionBlock);
                    
                    showErrorPanel();
                    statusBar.innerHTML = 'âŒ åŠ è½½å¤±è´¥ï¼ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…';
                    statusBar.style.cursor = 'pointer';
                    statusBar.style.background = 'rgba(255, 107, 107, 0.9)';
                    statusBar.onclick = () => showErrorPanel();
                }
            }, 2000);
        });
        
        // ç›‘å¬æ¥è‡ª IDE çš„æ¶ˆæ¯
        window.addEventListener('message', event => {
            const message = event.data;
            console.log('ğŸ“¨ æ”¶åˆ°æ¶ˆæ¯:', message);
        });
        
        // å¼€å‘æ¨¡å¼ï¼šæŒ‰ Cmd+R / Ctrl+R åˆ·æ–°é¡µé¢
        document.addEventListener('keydown', function(e) {
            if ((e.metaKey || e.ctrlKey) && e.key === 'r') {
                e.preventDefault();
                console.log('ğŸ”„ é‡æ–°åŠ è½½é¡µé¢...');
                location.reload();
            }
        });
        
        // æ˜¾ç¤ºé‡è½½æŒ‰é’®ï¼ˆæŒ‰ä½ Shift 3 ç§’ï¼‰
        let shiftTimer = null;
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Shift' && !shiftTimer) {
                shiftTimer = setTimeout(() => {
                    document.getElementById('dev-reload-btn').style.display = 'block';
                    console.log('ğŸ’¡ é‡è½½æŒ‰é’®å·²æ˜¾ç¤º');
                }, 3000);
            }
        });
        
        document.addEventListener('keyup', function(e) {
            if (e.key === 'Shift' && shiftTimer) {
                clearTimeout(shiftTimer);
                shiftTimer = null;
            }
        });
    </script>

    <!-- INLINE_CONFIG -->
    <!-- INLINE_APP -->
</body>

</html>

